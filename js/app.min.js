function addProductToCart(e,t){e.preventDefault();var r=$("div[data-product-id="+t+"]"),a=r.find(".product-img"),i=a.find("img"),n=r.find(".product-description"),c=n.find(".product-title");isCartFull()?$("#modalError").modal():(updateSummaryWithImage(i.attr("src"),getNextImageId()),cart.push({productId:t,src:i.attr("src"),title:c[0].innerText}),fireEventChanges()),scrollToTop()}function removeProductFromCart(e,t){e.preventDefault(),console.log("remove index "+t),cart.splice(t-1,1),rebuildSummaryItems(),fireEventChanges()}function handleBagSelect(e,t){e.preventDefault(),selectedBag=t,fireEventChanges()}function handleContinue(e){e.preventDefault();var t=new Array,r=new Array,a={};for(i=0;i<cart.length;i++)void 0==a[cart[i].productId]?(r.push(cart[i].productId),a[cart[i].productId]=1):a[cart[i].productId]=a[cart[i].productId]+1;for(i=0;i<r.length;i++)t.push({product:{id:r[i],quantity:a[r[i]]}});""!=selectedBag&&t.push({product:{id:selectedBag,quantity:1}}),alert(JSON.stringify(t))}function rebuildSummaryItems(){for(i=1;7>i;i++)console.log("clearing item "+i),updateSummaryWithImage("",i);for(i=1;i<=cart.length;i++)console.log("adding item "+i),updateSummaryWithImage(cart[i-1].src,i)}function buildSelectedItems(){var e=$(".selected-item-list");e.empty(),3==cart.length?(addSelectedItem(e,"",cart[0]),addSelectedItem(e,"",cart[1]),addSelectedItem(e,"",cart[2])):6==cart.length&&(addSelectedItem(e,"left",cart[0]),addSelectedItem(e,"left",cart[1]),addSelectedItem(e,"",cart[2]),addSelectedItem(e,"",cart[3]),addSelectedItem(e,"right",cart[4]),addSelectedItem(e,"right",cart[5])),$(".more-info-trigger a").click(function(e){$(this).hasClass("active")?($(this).removeClass("active"),$(".more-info-content").hide(),e.preventDefault()):($(".more-info-trigger a").removeClass("active"),$(".more-info-content").hide(),$(this).addClass("active"),$(this).parent().next(".more-info-content").show(),e.preventDefault())})}function addSelectedItem(e,t,r){var a='<div class="selected-item"><div class="selected-item-img"><img src="'+r.src+'"></div><div class="more-info"><div class="more-info-trigger"><a href="#"><span>Info</span></a></div><div class="more-info-content '+t+'"><span>'+r.title+"</span></div></div></div>";e.append(a)}function updateSummaryWithImage(e,t){var r=$(".item-"+t);r.addClass("selected");var a=r.find(".summary-item-img");""==e?(r.find(".summary-item-img").empty(),r.removeClass("selected")):a.html("<img onclick='removeProductFromCart(event,"+t+")' src='"+e+"'>")}function updateProgressIndicatorsAndPriceAndContinueAndBag(){updateProgressIndicators(),updatePrice(),updateContinue(),updateBagPrice()}function updateProgressIndicators(){areWeAtThree()?$(".summary-progress-3").addClass("complete"):$(".summary-progress-3").removeClass("complete"),areWeAtSix()?$(".summary-progress-6").addClass("complete"):$(".summary-progress-6").removeClass("complete")}function updatePrice(){$(".set-price").html("Price: &pound;"+getPrice())}function updateBagPrice(){var e=0;e=""==selectedBag?getPrice():getPrice()+prices.bagPrice,$(".total-price").html("Price: &pound;"+e)}function updateContinue(){canContinue()?$(".btn-continue").removeClass("disabled"):$(".btn-continue").addClass("disabled")}function canContinue(){return 3==getNumberOfItemsInCart()||6==getNumberOfItemsInCart()?!0:!1}function getPrice(){return cart.length<3?0:cart.length<6?prices.three:prices.six}function fireEventChanges(){updateProgressIndicatorsAndPriceAndContinueAndBag()}function getNextImageId(){return getNumberOfItemsInCart()+1}function isCartFull(){return cart.length>5}function isCartEmpty(){return cart.length-0}function getNumberOfItemsInCart(){return cart.length}function areWeAtThree(){return cart.length>=3}function areWeAtSix(){return 6==cart.length}function scrollToTop(){$(window).scrollTo($("#step-indicator-bar"),300,{axis:"y"})}$(function(){function e(){return"ontouchstart"in window||"onmsgesturechange"in window}e()?$("html").addClass("touch"):$("html").addClass("non-touch"),$(window).load(function(){$("#loader").fadeOut(),$("#overlay").delay(800).fadeOut("slow")}),//!! start of app scripts !!//
$('a[data-toggle="tab"]').on("shown.bs.tab",function(){var e=this.href.split("#");$(".nav a").filter('[href="#'+e[1]+'"]').tab("show")}),$(".partner-item a").click(function(e){$(".partner-item a").removeClass("selected"),$(this).addClass("selected"),e.preventDefault()}),$(".more-info-trigger a").click(function(e){$(this).hasClass("active")?($(this).removeClass("active"),$(".more-info-content").hide(),e.preventDefault()):($(".more-info-trigger a").removeClass("active"),$(".more-info-content").hide(),$(this).addClass("active"),$(this).parent().next(".more-info-content").show(),e.preventDefault())}),$("ul.category-list a").bind("click",function(e){$anchor=$(this).attr("href"),$(".product-container").stop().scrollTo($anchor,1e3,{axis:"x"}),e.preventDefault()}),$.each(["category-itemlist"],function(e,t){var r=$("."+t);r.each(function(){new Waypoint({element:this,handler:function(e){if("right"===e){var t=$("ul.category-list");r.removeClass("current"),t.find("a").removeClass("active"),$(this.element).addClass("current"),t.find('a[href="#'+$(this.element).attr("id")+'"]').addClass("active")}},offset:1,group:t,context:$(".product-container"),horizontal:!0})})}),$.each(["category-itemlist"],function(e,t){var r=$("."+t);r.each(function(){new Waypoint({element:this,handler:function(e){if("left"===e){var t=$("ul.category-list");r.removeClass("current"),t.find("a").removeClass("active"),$(this.element).addClass("current"),t.find('a[href="#'+$(this.element).attr("id")+'"]').addClass("active")}},offset:"right-in-view",group:t,context:$(".product-container"),horizontal:!0})})})});var selectedBag="",cart=new Array,prices={three:23,six:40,bagPrice:10};